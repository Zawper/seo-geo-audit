<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprawd≈∫ widoczno≈õƒá swojej strony</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gradient-to-br from-purple-50 via-pink-50 to-fuchsia-100 min-h-screen flex items-center justify-center p-4 md:p-8">
    
    <!-- SCREEN 1: Input Form -->
    <div id="screen1" class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full text-center">
        <h1 class="text-3xl font-bold text-gray-700 mb-2">Sprawd≈∫ czy Twoi klienci</h1>
        <p class="text-gray-600 mb-6">widzƒÖ twojƒÖ stronƒô w Google i chat'ach AI</p>
        
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2 text-left">E-mail</label>
                <input type="email" id="emailInput" placeholder="twoj@email.pl"    
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none">
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2 text-left">Adres strony</label>
                <input type="url" id="urlInput" placeholder="https://twojastrona.pl" 
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none">
            <input type="text" name="website" id="websiteField" 
       style="position: absolute; left: -9999px;" 
       tabindex="-1" 
       autocomplete="off">
            
            </div>
           <!-- Honeypot - ukryte dla ludzi, widoczne dla bot√≥w -->
<input type="text" name="website" id="websiteField" 
       style="position: absolute; left: -9999px;" 
       tabindex="-1" 
       autocomplete="off">
            
            <button onclick="startAudit()" 
                    class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-4 rounded-lg transition duration-200 transform hover:scale-105 mt-6 shadow-lg">
                üîç Sprawd≈∫ za darmo
               
            </button>
            
            <div class="mt-6 space-y-2">
                <p class="text-sm text-gray-500 text-center">‚è±Ô∏è Analiza trwa ~60 sekund</p>
                <div class="flex justify-center gap-6 flex-wrap">
                    <p class="text-sm text-gray-500">‚úì Bez logowania</p>
                    <p class="text-sm text-gray-500">‚úì Bez formalno≈õci</p>
                    <p class="text-sm text-gray-500">‚úì Dane bezpieczne</p>
                </div>
            </div>
        </div>
    </div>

    <!-- SCREEN 2: Loading -->
    <div id="screen2" class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full hidden">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Analizujƒô <span id="analyzingUrl" class="text-purple-600"></span></h2>
        
        <div class="mb-6">
            <div class="bg-gray-200 rounded-full h-4 overflow-hidden">
                <div id="progressBar" class="bg-gradient-to-r from-purple-600 to-pink-600 h-4 transition-all duration-500" style="width: 0%"></div>
            </div>
            <p id="progressText" class="text-center mt-2 text-gray-600">0%</p>
        </div>
        
        <div class="space-y-3">
            <div id="check1" class="flex items-center text-gray-400">
                <span class="mr-2">‚è≥</span> Szybko≈õƒá ≈Çadowania
            </div>
            <div id="check2" class="flex items-center text-gray-400">
                <span class="mr-2">‚è≥</span> Optymalizacja mobile
            </div>
            <div id="check3" class="flex items-center text-gray-400">
                <span class="mr-2">‚è≥</span> Test HTTPS
            </div>
            <div id="check4" class="flex items-center text-gray-400">
                <span class="mr-2">‚è≥</span> ChatGPT visibility
            </div>
            <div id="check5" class="flex items-center text-gray-400">
                <span class="mr-2">‚è≥</span> Gemini visibility
            </div>
            <div id="check6" class="flex items-center text-gray-400">
                <span class="mr-2">‚è≥</span> Schema Markup
            </div>
        </div>
    </div>

    <!-- SCREEN 3: Results -->
    <div id="screen3" class="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full hidden">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Wynik dla <span id="resultUrl" class="text-purple-600"></span></h2>
        
        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <!-- Chart -->
            <div class="flex flex-col items-center justify-center">
                <canvas id="scoreChart" width="200" height="200"></canvas>
            </div>
            
            <!-- Score Info -->
            <div class="flex flex-col justify-center">
                <div class="text-center md:text-left">
                    <p class="text-gray-600 mb-2">WIDOCZNO≈öƒÜ:</p>
                    <h3 id="visibilityStatus" class="text-3xl font-bold mb-2">üî¥ NISKA</h3>
                    <p id="visibilityImpact" class="text-gray-600">Tracisz ~70% potencjalnych klient√≥w!</p>
                </div>
            </div>
        </div>
        
        <!-- Problems -->
        <div class="bg-red-50 border-l-4 border-red-500 p-6 mb-8 rounded">
            <h3 class="text-xl font-bold text-red-800 mb-4">‚ùå PILNE DO NAPRAWY:</h3>
            <div id="problemsList" class="space-y-4"></div>
        </div>
        
        <!-- Packages -->
        <div class="mb-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">üí° NAPRAWIMY TO ZA CIEBIE:</h3>
            <div class="grid md:grid-cols-2 gap-4">
                <!-- Basic Package -->
                <div class="border-2 border-purple-500 rounded-lg p-6 hover:shadow-xl transition duration-200 hover:border-purple-600">
                    <h4 class="text-xl font-bold text-purple-600 mb-3">üì¶ BASIC SEO/GEO</h4>
                    <ul class="text-sm text-gray-700 space-y-2 mb-4">
                        <li>‚úì Optymalizacja PageSpeed</li>
                        <li>‚úì Schema Markup</li>
                        <li>‚úì AI visibility boost</li>
                        <li>‚úì Raport miesiƒôczny</li>
                    </ul>
                    <p class="text-2xl font-bold text-gray-800 mb-4">200‚Ç¨/mies</p>
                    <button onclick="selectPackage('basic')" 
                            class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-3 rounded-lg transition shadow-lg">
                        WYBIERAM
                    </button>
                </div>
                
                <!-- Pro Package -->
                <div class="border-2 border-pink-500 rounded-lg p-6 hover:shadow-xl transition duration-200 hover:border-pink-600">
                    <h4 class="text-xl font-bold text-pink-600 mb-3">üöÄ PRO MARKETING</h4>
                    <ul class="text-sm text-gray-700 space-y-2 mb-4">
                        <li>‚úì Kompleksowa strategia</li>
                        <li>‚úì Content marketing</li>
                        <li>‚úì Kampanie reklamowe</li>
                        <li>‚úì Dedykowany manager</li>
                    </ul>
                    <p class="text-lg font-bold text-gray-800 mb-4">Indywidualna wycena</p>
                    <button onclick="selectPackage('pro')" 
                            class="w-full bg-gradient-to-r from-pink-600 to-fuchsia-600 hover:from-pink-700 hover:to-fuchsia-700 text-white font-bold py-3 rounded-lg transition shadow-lg">
                        KONTAKT
                    </button>
                </div>
            </div>
        </div>
        
        <p class="text-center text-gray-500 text-sm">
            üìß Pe≈Çna analiza wys≈Çana na: <span id="userEmail" class="font-semibold"></span>
        </p>
    </div>

    <script>
        let auditData = {};
        
        function startAudit() {
            const email = document.getElementById('emailInput').value;
            const url = document.getElementById('urlInput').value;
// Honeypot check - zatrzymaj boty
    const honeypot = document.getElementById('websiteField').value;
    if (honeypot) {
        // Bot wype≈Çni≈Ç ukryte pole - ignoruj bez komunikatu
        console.log('Bot detected');
        return;
    }
            
            // Validation z ≈Çadnymi modalami
    if (!email || !url) {
        showModal('Wype≈Çnij wszystkie pola');
        return;
    }
    
    if (!email.includes('@')) {
        showModal('Podaj prawid≈Çowy email');
        return;
    }
    
    if (!url.startsWith('http')) {
        showModal('URL musi zaczynaƒá siƒô od https://');
        return;
    }
    
    // Show screen 2
            document.getElementById('screen1').classList.add('hidden');
            document.getElementById('screen2').classList.remove('hidden');
            document.getElementById('analyzingUrl').textContent = url;
            
            // Start analysis
            runAnalysis(email, url);
        }
        
        async function runAnalysis(email, url) {
            const checks = [
                { id: 'check1', name: 'PageSpeed', delay: 8000 },
                { id: 'check2', name: 'Mobile', delay: 3000 },
                { id: 'check3', name: 'HTTPS', delay: 2000 },
                { id: 'check4', name: 'ChatGPT', delay: 10000 },
                { id: 'check5', name: 'Gemini', delay: 10000 },
                { id: 'check6', name: 'Schema', delay: 7000 }
            ];
            
            let progress = 0;
            const progressIncrement = 100 / checks.length;
            
            for (let i = 0; i < checks.length; i++) {
                await new Promise(resolve => setTimeout(resolve, checks[i].delay));
                
                // Update check
                const checkEl = document.getElementById(checks[i].id);
                checkEl.innerHTML = `<span class="mr-2">‚úì</span> ${checkEl.textContent.substring(2)}`;
                checkEl.classList.remove('text-gray-400');
                checkEl.classList.add('text-green-600');
                
                // Update progress
                progress += progressIncrement;
                document.getElementById('progressBar').style.width = progress + '%';
                document.getElementById('progressText').textContent = Math.round(progress) + '%';
            }
            
            // Call backend API
            try {
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, url })
                });
                
                auditData = await response.json();
                showResults(email, url, auditData);
            } catch (error) {
                // Mock data for demo
                auditData = {
                    score: 47,
                    pageSpeed: 35,
                    loadTime: 4.2,
                    mobileFriendly: false,
                    https: true,
                    chatGPTCitation: false,
                    geminiCitation: false,
                    schemaMarkup: false
                };
                showResults(email, url, auditData);
            }
        }
        
        function showResults(email, url, data) {
            // Hide screen 2, show screen 3
            document.getElementById('screen2').classList.add('hidden');
            document.getElementById('screen3').classList.remove('hidden');
            
            document.getElementById('resultUrl').textContent = url;
            document.getElementById('userEmail').textContent = email;
            
            // Create chart
            const ctx = document.getElementById('scoreChart').getContext('2d');
            const chartColor = data.score >= 70 ? '#10b981' : data.score >= 40 ? '#f59e0b' : '#ef4444';
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [data.score, 100 - data.score],
                        backgroundColor: [chartColor, '#e5e7eb'],
                        borderWidth: 0
                    }]
                },
                options: {
                    cutout: '75%',
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    }
                },
                plugins: [{
                    beforeDraw: function(chart) {
                        const width = chart.width;
                        const height = chart.height;
                        const ctx = chart.ctx;
                        ctx.restore();
                        const fontSize = (height / 80).toFixed(2);
                        ctx.font = fontSize + "em sans-serif";
                        ctx.textBaseline = "middle";
                        const text = data.score + "%";
                        const textX = Math.round((width - ctx.measureText(text).width) / 2);
                        const textY = height / 2;
                        ctx.fillText(text, textX, textY);
                        ctx.save();
                    }
                }]
            });
            
            // Visibility status
            const statusEl = document.getElementById('visibilityStatus');
            const impactEl = document.getElementById('visibilityImpact');
            
            if (data.score >= 70) {
                statusEl.textContent = 'üü¢ DOBRA';
                statusEl.className = 'text-3xl font-bold mb-2 text-green-600';
                impactEl.textContent = '≈öwietnie! Twoja strona jest dobrze widoczna.';
            } else if (data.score >= 40) {
                statusEl.textContent = 'üü° ≈öREDNIA';
                statusEl.className = 'text-3xl font-bold mb-2 text-yellow-600';
                impactEl.textContent = 'Tracisz ~40% potencjalnych klient√≥w!';
            } else {
                statusEl.textContent = 'üî¥ NISKA';
                statusEl.className = 'text-3xl font-bold mb-2 text-red-600';
                impactEl.textContent = 'Tracisz ~70% potencjalnych klient√≥w!';
            }
            
            // Problems list
            const problems = getTop2Problems(data);
            const problemsListEl = document.getElementById('problemsList');
            problemsListEl.innerHTML = problems.map((p, i) => `
                <div class="border-l-2 border-red-400 pl-4">
                    <p class="font-bold text-gray-800">${i + 1}. ${p.title}</p>
                    <p class="text-sm text-gray-600">‚Üí ${p.impact}</p>
                </div>
            `).join('');
        }
        
        function getTop2Problems(data) {
            const problems = [];
            
            if (data.pageSpeed < 60) {
                problems.push({
                    title: `Strona ≈Çaduje siƒô ${data.loadTime}s`,
                    impact: 'U≈ºytkownicy uciekajƒÖ po 3s - tracisz klient√≥w'
                });
            }
            
            if (!data.chatGPTCitation && !data.geminiCitation) {
                problems.push({
                    title: 'ChatGPT i Gemini nie znajƒÖ Twojej firmy',
                    impact: 'Konkurencja zabiera klient√≥w z AI'
                });
            }
            
            if (!data.mobileFriendly) {
                problems.push({
                    title: 'Strona nie dzia≈Ça na telefonach',
                    impact: '70% u≈ºytkownik√≥w korzysta z mobile'
                });
            }
            
            if (!data.https) {
                problems.push({
                    title: 'Brak certyfikatu bezpiecze≈Ñstwa',
                    impact: 'Google karze strony bez HTTPS'
                });
            }
            
            if (!data.schemaMarkup) {
                problems.push({
                    title: 'Brak Schema Markup',
                    impact: 'AI nie rozumie struktury Twojej strony'
                });
            }
            
            return problems.slice(0, 2);
        }
        
        function selectPackage(type) {
            const email = document.getElementById('userEmail').textContent;
            const url = document.getElementById('resultUrl').textContent;
            
            if (type === 'basic') {
                window.location.href = `mailto:pomelomarketingandsoft@gmail.com?subject=Zam√≥wienie BASIC SEO/GEO&body=Email: ${email}%0AStrona: ${url}%0A%0AChcƒô zam√≥wiƒá pakiet BASIC za 200‚Ç¨/mies`;
            } else {
                window.location.href = `mailto:pomelomarketingandsoft@gmail.com?subject=Wycena PRO MARKETING&body=Email: ${email}%0AStrona: ${url}%0A%0AProszƒô o indywidualnƒÖ wycenƒô pakietu PRO`;
            }
        }
        function showModal(message) {
            const backdrop = document.createElement('div');
            backdrop.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            backdrop.onclick = () => backdrop.remove();
            
            const modal = document.createElement('div');
            modal.className = 'bg-white rounded-2xl p-8 max-w-sm mx-4 shadow-2xl';
            modal.innerHTML = `
                <div class="text-center">
                    <div class="text-4xl mb-4">‚ö†Ô∏è</div>
                    <p class="text-lg text-gray-800 mb-6">${message}</p>
                    <button onclick="this.closest('.fixed').remove()" 
                            class="bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-bold py-3 px-8 rounded-lg transition shadow-lg">
                        OK
                    </button>
                </div>
            `;
            
            backdrop.appendChild(modal);
            document.body.appendChild(backdrop);
        }
    </script>
</body>
</html>
